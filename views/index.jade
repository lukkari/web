extends ./layouts/main

block content
  div.topmenu
    ul
      li: a#group(href='/' data-ref='Groups') Groups
      li: a#teacher(href='/' data-ref='Teachers') Teachers


  div.subjectpage
    div.inner
      div.back: a(href='/back' data-local) Return
      article


  div.mainpage
    h3 Schedule finder
    div.block Custom schedule of ICT-building

    h3 How to use
    div.block
      h4 Basics
      div.subblock
        b Choose schedule
        div.info Click on any of two links on the top of the page and then choose your group or if you are looking for a teacher timetable choose teacher.
          s To filter list start typing group name or teacher.
          | You can quickly access your teachers timetable by clicking on them in your schedule.

        b Choose week
        div.info To choose other week you can click on a wide button with week number or use quick links for previous and next weeks. Blue week selection shows current week and grey selection means week which you chose.

      h4 Save links
      div.subblock You can save link and access it at any time. You will always see your current week timetable.
        div.attention If you open your timetable on saturday or sunday, you will see the next week schedule.

      h4 Contacts
      div.subblock If you have any suggestions or questions, please, contact me.
        div.contactform
          div.success#sent Thank you for texting me
          textarea.text#message(placeholder='Input your message')
          div#hiddenform
            input.text#replyto(type='text' placeholder='Reply to or at least your name')
            input.button#send(type='button' value='Send')

  div.schedule
    article
      div.weekblock
        div#calendar
          each month in calendar
            table
              thead
                tr
                  th(colspan='6') #{month.month}
                tr
                  th #
                  th Mo
                  th Tu
                  th We
                  th Th
                  th Fr
              tbody
                each week in month.dates
                  - var trClass = (week.curweek == 0) ? 'current' : ''
                  tr(class=trClass data-link='w#{week.week}')
                    th #{week.week}
                    each day in week.days
                      - var tdClass = (day.old > 0) ? 'old' : ''
                      td(class=tdClass) #{day.day}

          div.klear

        div.weekselector
          a.neighbourweek#prevweek(href='/' data-week='#{weeknum-1}' data-local) Prev
          a.weekcontent(href='/') Week
            span#weeknum(data-week='#{weeknum}' data-weeknow='#{weeknow}') #{weeknum}
          a.neighbourweek#nextweek(href='/' data-week='#{weeknum+1}' data-local) Next

      div#days

  div.klear

  div.unknown Keep calm and don't experiment with url

  div.sidebarwrap
    div.bg
    div.sidebar
      a.closebtn(href='/') Close
      div.container
        div#groupList
          div.search
            input.text#groupFilter(type='text' placeholder='Type to filter groups')
          div.list

        div#teacherList
          div.search
            input.text#teacherFilter(type='text' placeholder='Type to filter teachers')
          div.list
      div.klear


block customFoot
  script#weekdayTemplate(type='text/html')
    div.block(class!='<%= (isToday(date)) ? "today" : "" %>')
      div.weekday <%= weekday.name %>
        div.date
          div.day <%= date.day %>
          div.month <%= getMonth(date.month) %>

      div.container
        <% if(subjects.length > 0) { %><% _.each(subjects, function (subject) { %>
        div.subject
          div.time
            div.hour <%= getTime(subject.days) %>
            div.duration
              span(class!='dur-<%= getDur(subject.days) %>')
                i#duration <%= getDur(subject.days) %>
                u hour<% if(getDur(subject.days) > 1) { %>s<% } %>

          div.info
            div.inner
              div.name
                <% if(subject.rest) { %>
                div.resttext Break
                <% } else { %>
                a(href!='/subject/<%= toUrl(subject.name) %>' data-local) <%= subject.name %>
                <% } %>

              div.room <%= getRooms(subject.rooms) %>

              ul.teachers
                <% _.each(subject.teachers, function (teacher) { %>
                li: a(href!='/<%= toUrl(teacher.name) %>' data-local) <%= teacher.name %>
                <% }); %>

          ul.groups
            <% _.each(subject.groups, function (group) { %>
            li: a(href!='/<%= toUrl(group.name) %>' data-local) <%= group.name %>
            <% }); %>

          div.klear

        <% }); %><% } else { %>
        div.noclasses No classes
        <% } %>

  script#weekNotFound(type='text/html')
    div.notfound Not found

  script#itemlinkTemplate(type='text/html')
    li: a(href!='/<%= tourl %>' data-local)<%= name %>

  script#subjectTemplate(type='text/html')
    div.row
      h3 <%= name %>

    div.row
      h4 Teachers
      div.teachers
        ul
          <% _.each(teachers, function (teacher) { %>
          li: a(href!='<%= toUrl(teacher.name) %>' data-local) <%= teacher.name %>
          <% }); %>

    div.row
      h4 Groups
      div.groups
        ul
          <% _.each(groups, function (group) { %>
          li: a(href!='<%= toUrl(group.name) %>' data-local) <%= group.name %>
          <% }); %>

    div.row
      h4 When
      div: i Will be available soon

  script(src='/js/libs/jquery-1.10.2.min.js')
  script(src='/js/libs/jquery.equalheights.min.js')
  script(src='/js/libs/underscore-min.js')
  script(src='/js/libs/backbone-min.js')
  script(src='/js/app.js')


block footlinks
  if logged
    include ./layouts/footlinks/logged
  else
    include ./layouts/footlinks/unlogged